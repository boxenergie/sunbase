<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<title>SunShare</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<link rel='stylesheet' type='text/css' media='screen' href='css/main.css'>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js'></script>
	<script src='/js/PCS-chart.js'></script>
</head>
<body>
<h1>SunShare Board</h1>

{{if(options.user)}}	
	<h3>Hello <i>{{user.username}}</i> !</h3>
{{/if}}

<h4>Global records</h4>
{{if(!options.globalData)}}
	<p>No global records</p>
{{#else}}
	<canvas id="globalChart" width="800" height="400"></canvas>

	<script>
		const ctx = document.getElementById('globalChart').getContext('2d');
		const labels = [{{foreach(options.globalData.time)}} '{{@this}}'.slice(11, 16), {{/foreach}}];
		const production = [{{globalData.production}}];
		const consumption = [{{globalData.consumption}}];
		const surplus = [{{globalData.surplus}}];
		
		createChart(ctx, labels, production, consumption, surplus);
	</script>
{{/if}}

{{if(options.user)}}
	<h4>Personal records</h4>
	{{if(!options.userData)}}
		<p>No personal records</p>
	{{#else}}
		<canvas id="personnalChart" width="800" height="400"></canvas>

		<script>
			const ctx = document.getElementById('personnalChart').getContext('2d');
			const labels = [{{foreach(options.userData.time)}} '{{@this}}'.slice(11, 16), {{/foreach}}];
			const production = [{{userData.production}}];
			const consumption = [{{userData.consumption}}];
			const surplus = [{{userData.surplus}}];
			
			createChart(ctx, labels, production, consumption, surplus);
		</script>
	{{/if}}
{{/if}}

{{if(!options.user)}}
	<a href="/login"><button>Login</button></a>
{{#else}}
	<a href="/profil"><button>Profil</button></a>
	<a href="/logout"><button>Logout</button></a>
	{{if(options.user.role == 'admin')}}
		<a href="/admin"><button>Admin Dashboard</button></a>
	{{/if}}
{{/if}}

<a class="bottom-link" href="https://github.com/boxenergie/sunbase">Voir le code source</a>
</body>
</html>
