<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<title>SunShare</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<link rel='stylesheet' type='text/css' media='screen' href='css/main.css'>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js'></script>
	<script src='/js/PCS-chart.js'></script>
</head>
<body>
<!-- TODO embed this page in home-controller ?-->
<h1>SunShare Board</h1>

{{if(options.user)}}
	<h4>Records of {{user.username}}</h4>
	{{if(!options.userData.production.length > 0)}}
		<p>No personal records</p>
	{{#else}}
		<canvas id="personalChart" width="800" height="400"></canvas>

		<script>
			const personalCtx = document.getElementById('personalChart').getContext('2d');
			const personalLabels = [
				{{foreach(options.userData.time)}}
					new Date('{{@this}}').toLocaleTimeString("fr-FR").slice(0, 5), 
				{{/foreach}}
			];
			const personalProduction = [{{userData.production}}];
			const personalConsumption = [{{userData.consumption}}];
			const personalSurplus = [{{userData.surplus}}];

			createChart(
				personalCtx,
				personalLabels,
				personalProduction,
				personalConsumption,
				personalSurplus
			);
		</script>
	{{/if}}
{{/if}}

<a href="/"><button>Home</button></a>
</body>
</html>
