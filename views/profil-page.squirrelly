<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<title>SunShare</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<link rel='stylesheet' type='text/css' media='screen' href='css/main.css'>
	<script src='main.js'></script>
</head>
<body>
    {{if(options.errorMsg != '')}}
        <p class='errorMsg'>{{errorMsg}}</p>
    {{/if}}
    {{if(options.successMsg != '')}}
        <p class='successMsg'>{{successMsg}}</p>
    {{/if}}

    <h5>Change username</h5>
    <form action="/profil/update_username/" method="post">
		<input type="hidden" name="_csrf" value="{{csrfToken}}">
		<label for="pwd">Password:&nbsp;</label>
		<input type="password" id="pwd" name="pwd"><br/>
		<label for="new_username">New username:&nbsp;</label>
		<input type="text" name="new_username" id="new_username">
		<input type="submit" value="submit">
    </form>
    
    <h5>Change password</h5>
	<form action="/profil/update_password/" method="post">
		<input type="hidden" name="_csrf" value="{{csrfToken}}">
		<label for="old_pwd">Old password:&nbsp;</label>
		<input type="password" id="old_pwd" name="old_pwd"><br/>
		<label for="new_pwd">New password:&nbsp;</label>
		<input type="password" name="new_pwd" id="new_pwd"><br/>
		<label for="new_pwd_confirm">Confirm new password:&nbsp;</label>
		<input type="password" name="new_pwd_confirm" id="new_pwd_confirm">
		<input type="submit" value="submit">
	</form>

	<h5>Permissions</h5>
	<form action="/profil/request_permissions/" method="POST">
		<input type="hidden" name="_csrf" value="{{csrfToken}}">
		<fieldset>
			<legend>Permissions that were granted to you:</legend>
			<div>
				{{foreach(options.permissions.granted)}}
				<b>{{@key}}</b>: {{each(@this)}}{{@this}}{{/each}}
				{{/foreach}}
			</div>
			<!--
			<fieldset>
				<legend>Request a permission grant: </legend>
				<label for="requested-permission">Request the permission to:</label>
				<select name="permission" id="requested-permission">
					<option value="read">Read User Data</option>
				</select>
				<label for="grantor">from the user:</label>
				<input type="text" name="grantor" id="grantor">
				<br/>
				<input type="submit" value="Submit">
			</fieldset>
			-->
		</fieldset>
	</form>
	<form action="./update_permissions/" method="POST">
		<input type="hidden" name="_csrf" value="{{csrfToken}}">
		<fieldset>
			<legend>Permissions that you grant to other people:</legend>
			<ul>
				{{foreach(options.permissions.granting) granting}}
					<li>
						<b>{{@key}}</b>:
						{{each(@this)}} {{@this}}
							<a href="./update_permissions/?rmUser={{@granting:key}}&rmPerm={{@this}}"><button type="button">Revoke</button></a>
						{{/each}}
					</li>
				{{/foreach}}
			</ul>
			<fieldset>
				<legend>Grant a permission to someone:</legend>
				<label for="grantedPermission">Grant the permission to:</label>
				<select name="permission" id="grantedPermission">
					<option value="read">Read My Data</option>
				</select>
				<label for="grantee">to the user:</label>
				<input type="text" name="grantee" id="grantee">
				<br/>
				<input type="submit" value="Submit">
			</fieldset>
		</fieldset>
	</form>
    
    <a href="/"><button>Home</button></a>
</body>
</html>
